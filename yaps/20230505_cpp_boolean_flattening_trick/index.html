<html lang=en><head><meta charset=UTF-8><link rel=stylesheet href=/css/common.css><link rel=stylesheet href=/css/syntax.css><link rel="shortcut icon" type=image/png href=/img/favicon.png><title>moom</title>
<script>MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]],processEscapes:!0,processEnvironments:!0},options:{skipHtmlTags:["script","noscript","style","textarea","pre"]}},window.addEventListener("load",e=>{document.querySelectorAll("mjx-container").forEach(function(e){e.parentElement.classList+="has-jax"})})</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script type=text/javascript id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script></head><body><div id=container><div id=title>momo</div><div id=blog_box><div class=blog_title><h1>[C/C++] Flatten integer to 0/1</h1></div><div class=blog_date><time datetime=2023-05-05T13:25:00+08:00><h2>May 5, 2023</h2></time></div><div class=blog_body><p>This is a quick trick to &lsquo;flatten&rsquo; an integer into a 1 or 0.
This is probably a trick that only works in C/C++ because of how the not (!) operator works with integers.
While it&rsquo;s usefulness is dubious in C++, it might be useful in C.</p><p>The trick is simply this:</p><div class=highlight><div style=color:#ebdbb2;background-color:#282828;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#ebdbb2;background-color:#282828;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-0-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#ebdbb2;background-color:#282828;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-cpp data-lang=cpp><span style=display:flex><span>x <span style=color:#fe8019>=</span> <span style=color:#fe8019>!!</span>x;
</span></span></code></pre></td></tr></table></div></div><p>When <code>x</code> is 0, x will remain 0.
When <code>x</code> is any other number, x will be &lsquo;flattened&rsquo; to 1.</p><p>You might ask, why not do something like this?</p><div class=highlight><div style=color:#ebdbb2;background-color:#282828;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#ebdbb2;background-color:#282828;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-1-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#ebdbb2;background-color:#282828;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-cpp data-lang=cpp><span style=display:flex><span>x <span style=color:#fe8019>=</span> x <span style=color:#fe8019>?</span> <span style=color:#d3869b>1</span> <span style=color:#fe8019>:</span> <span style=color:#d3869b>0</span>;
</span></span></code></pre></td></tr></table></div></div><p>Does the statement above use more instruction because it is a conditional?</p><p>Don&rsquo;t worry, my friend.
I got you covered.
I&rsquo;m a good engineer who at least have the decency to check against <a href>Godbolt</a>:</p><div class=highlight><div style=color:#ebdbb2;background-color:#282828;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#ebdbb2;background-color:#282828;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-2-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-2-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-2-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-2-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-2-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-2-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-2-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-2-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-2-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-2-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-2-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-2-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-2-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-2-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-2-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-2-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-2-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-2-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-18>18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-2-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-19>19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-2-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-20>20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-2-21><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-21>21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-2-22><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-22>22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-2-23><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-23>23</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#ebdbb2;background-color:#282828;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#8ec07c>#include</span> <span style=color:#8ec07c;font-style:italic>&lt;stdio.h&gt;</span><span style=color:#8ec07c>
</span></span></span><span style=display:flex><span><span style=color:#8ec07c></span>
</span></span><span style=display:flex><span><span style=color:#fabd2f>int</span> g_fullscreen;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#fabd2f>int</span> <span style=color:#fabd2f>foo3</span>() {
</span></span><span style=display:flex><span>  <span style=color:#fe8019>if</span> (g_fullscreen)
</span></span><span style=display:flex><span>    <span style=color:#fe8019>return</span> <span style=color:#d3869b>1</span>;
</span></span><span style=display:flex><span>  <span style=color:#fe8019>else</span> 
</span></span><span style=display:flex><span>    <span style=color:#fe8019>return</span> <span style=color:#d3869b>0</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#fabd2f>int</span> <span style=color:#fabd2f>foo2</span>() {
</span></span><span style=display:flex><span>  <span style=color:#fe8019>return</span> <span style=color:#fe8019>!!</span>g_fullscreen;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#fabd2f>int</span> <span style=color:#fabd2f>foo1</span>() {
</span></span><span style=display:flex><span>  <span style=color:#fe8019>return</span> g_fullscreen <span style=color:#fe8019>?</span> <span style=color:#d3869b>1</span> <span style=color:#fe8019>:</span> <span style=color:#d3869b>0</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#fabd2f>int</span> <span style=color:#fabd2f>main</span>() {
</span></span><span style=display:flex><span>  foo1();
</span></span><span style=display:flex><span>  foo2();
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><p>And turns out, in all relevant compilers today (GCC, Clang and MSVC), they all give the same instructions.</p><p>Here is Clang:</p><div class=highlight><div style=color:#ebdbb2;background-color:#282828;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#ebdbb2;background-color:#282828;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-3-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-3-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-3-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-3-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-3-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-3-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-3-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-3-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-3-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-3-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-3-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-3-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-3-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-3-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-3-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-3-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-3-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-3-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-18>18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-3-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-19>19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-3-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-20>20</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#ebdbb2;background-color:#282828;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-asm data-lang=asm><span style=display:flex><span><span style=color:#fabd2f>foo3</span>():                               <span style=color:#928374;font-style:italic># @foo3()
</span></span></span><span style=display:flex><span><span style=color:#928374;font-style:italic></span>        <span style=color:#fabd2f>xor</span>     <span style=color:#d3869b>eax</span>, <span style=color:#d3869b>eax</span>
</span></span><span style=display:flex><span>        <span style=color:#fabd2f>cmp</span>     <span style=color:#d3869b>dword</span> <span style=color:#d3869b>ptr</span> [<span style=color:#d3869b>rip</span> + <span style=color:#d3869b>g_fullscreen</span>], <span style=color:#d3869b>0</span>
</span></span><span style=display:flex><span>        <span style=color:#fabd2f>setne</span>   <span style=color:#d3869b>al</span>
</span></span><span style=display:flex><span>        <span style=color:#fabd2f>ret</span>
</span></span><span style=display:flex><span><span style=color:#fabd2f>foo2</span>():                               <span style=color:#928374;font-style:italic># @foo2()
</span></span></span><span style=display:flex><span><span style=color:#928374;font-style:italic></span>        <span style=color:#fabd2f>xor</span>     <span style=color:#d3869b>eax</span>, <span style=color:#d3869b>eax</span>
</span></span><span style=display:flex><span>        <span style=color:#fabd2f>cmp</span>     <span style=color:#d3869b>dword</span> <span style=color:#d3869b>ptr</span> [<span style=color:#d3869b>rip</span> + <span style=color:#d3869b>g_fullscreen</span>], <span style=color:#d3869b>0</span>
</span></span><span style=display:flex><span>        <span style=color:#fabd2f>setne</span>   <span style=color:#d3869b>al</span>
</span></span><span style=display:flex><span>        <span style=color:#fabd2f>ret</span>
</span></span><span style=display:flex><span><span style=color:#fabd2f>foo1</span>():                               <span style=color:#928374;font-style:italic># @foo1()
</span></span></span><span style=display:flex><span><span style=color:#928374;font-style:italic></span>        <span style=color:#fabd2f>xor</span>     <span style=color:#d3869b>eax</span>, <span style=color:#d3869b>eax</span>
</span></span><span style=display:flex><span>        <span style=color:#fabd2f>cmp</span>     <span style=color:#d3869b>dword</span> <span style=color:#d3869b>ptr</span> [<span style=color:#d3869b>rip</span> + <span style=color:#d3869b>g_fullscreen</span>], <span style=color:#d3869b>0</span>
</span></span><span style=display:flex><span>        <span style=color:#fabd2f>setne</span>   <span style=color:#d3869b>al</span>
</span></span><span style=display:flex><span>        <span style=color:#fabd2f>ret</span>
</span></span><span style=display:flex><span><span style=color:#fb4934>main:</span>                                   <span style=color:#928374;font-style:italic># @main
</span></span></span><span style=display:flex><span><span style=color:#928374;font-style:italic></span>        <span style=color:#fabd2f>xor</span>     <span style=color:#d3869b>eax</span>, <span style=color:#d3869b>eax</span>
</span></span><span style=display:flex><span>        <span style=color:#fabd2f>ret</span>
</span></span><span style=display:flex><span><span style=color:#fb4934>g_fullscreen:</span>
</span></span><span style=display:flex><span>        <span style=color:#b8bb26;font-weight:700>.long</span>   <span style=color:#d3869b>0</span>                               <span style=color:#928374;font-style:italic># 0x0
</span></span></span></code></pre></td></tr></table></div></div><p>MSVC</p><div class=highlight><div style=color:#ebdbb2;background-color:#282828;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#ebdbb2;background-color:#282828;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-4-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-4-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-4-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-4-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-4-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-4-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-4-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-4-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-4-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-4-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-4-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-4-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-4-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-4-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-4-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-4-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-4-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-4-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-18>18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-4-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-19>19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-4-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-20>20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-4-21><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-21>21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-4-22><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-22>22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-4-23><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-23>23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-4-24><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-24>24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-4-25><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-25>25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-4-26><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-26>26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-4-27><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-27>27</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#ebdbb2;background-color:#282828;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-asm data-lang=asm><span style=display:flex><span><span style=color:#fabd2f>int</span> <span style=color:#d3869b>g_fullscreen</span> <span style=color:#d3869b>DD</span> <span style=color:#d3869b>01</span><span style=color:#d3869b>H</span> <span style=color:#d3869b>DUP</span> (?)                 <span style=color:#928374;font-style:italic>; g_fullscreen
</span></span></span><span style=display:flex><span><span style=color:#928374;font-style:italic></span>
</span></span><span style=display:flex><span><span style=color:#fabd2f>int</span> <span style=color:#d3869b>foo3</span>(<span style=color:#d3869b>void</span>) <span style=color:#d3869b>PROC</span>                                 <span style=color:#928374;font-style:italic>; foo3, COMDAT
</span></span></span><span style=display:flex><span><span style=color:#928374;font-style:italic></span>        <span style=color:#fabd2f>xor</span>     <span style=color:#d3869b>eax</span>, <span style=color:#d3869b>eax</span>
</span></span><span style=display:flex><span>        <span style=color:#fabd2f>cmp</span>     <span style=color:#d3869b>DWORD</span> <span style=color:#d3869b>PTR</span> <span style=color:#d3869b>int</span> <span style=color:#d3869b>g_fullscreen</span>, <span style=color:#d3869b>eax</span> <span style=color:#928374;font-style:italic>; g_fullscreen
</span></span></span><span style=display:flex><span><span style=color:#928374;font-style:italic></span>        <span style=color:#fabd2f>setne</span>   <span style=color:#d3869b>al</span>
</span></span><span style=display:flex><span>        <span style=color:#fabd2f>ret</span>     <span style=color:#d3869b>0</span>
</span></span><span style=display:flex><span><span style=color:#fabd2f>int</span> <span style=color:#d3869b>foo3</span>(<span style=color:#d3869b>void</span>) <span style=color:#d3869b>ENDP</span>                                 <span style=color:#928374;font-style:italic>; foo3
</span></span></span><span style=display:flex><span><span style=color:#928374;font-style:italic></span>
</span></span><span style=display:flex><span><span style=color:#fabd2f>int</span> <span style=color:#d3869b>foo2</span>(<span style=color:#d3869b>void</span>) <span style=color:#d3869b>PROC</span>                                 <span style=color:#928374;font-style:italic>; foo2, COMDAT
</span></span></span><span style=display:flex><span><span style=color:#928374;font-style:italic></span>        <span style=color:#fabd2f>xor</span>     <span style=color:#d3869b>eax</span>, <span style=color:#d3869b>eax</span>
</span></span><span style=display:flex><span>        <span style=color:#fabd2f>cmp</span>     <span style=color:#d3869b>DWORD</span> <span style=color:#d3869b>PTR</span> <span style=color:#d3869b>int</span> <span style=color:#d3869b>g_fullscreen</span>, <span style=color:#d3869b>eax</span> <span style=color:#928374;font-style:italic>; g_fullscreen
</span></span></span><span style=display:flex><span><span style=color:#928374;font-style:italic></span>        <span style=color:#fabd2f>setne</span>   <span style=color:#d3869b>al</span>
</span></span><span style=display:flex><span>        <span style=color:#fabd2f>ret</span>     <span style=color:#d3869b>0</span>
</span></span><span style=display:flex><span><span style=color:#fabd2f>int</span> <span style=color:#d3869b>foo2</span>(<span style=color:#d3869b>void</span>) <span style=color:#d3869b>ENDP</span>                                 <span style=color:#928374;font-style:italic>; foo2
</span></span></span><span style=display:flex><span><span style=color:#928374;font-style:italic></span>
</span></span><span style=display:flex><span><span style=color:#fabd2f>int</span> <span style=color:#d3869b>foo1</span>(<span style=color:#d3869b>void</span>) <span style=color:#d3869b>PROC</span>                                 <span style=color:#928374;font-style:italic>; foo1, COMDAT
</span></span></span><span style=display:flex><span><span style=color:#928374;font-style:italic></span>        <span style=color:#fabd2f>xor</span>     <span style=color:#d3869b>eax</span>, <span style=color:#d3869b>eax</span>
</span></span><span style=display:flex><span>        <span style=color:#fabd2f>cmp</span>     <span style=color:#d3869b>DWORD</span> <span style=color:#d3869b>PTR</span> <span style=color:#d3869b>int</span> <span style=color:#d3869b>g_fullscreen</span>, <span style=color:#d3869b>eax</span> <span style=color:#928374;font-style:italic>; g_fullscreen
</span></span></span><span style=display:flex><span><span style=color:#928374;font-style:italic></span>        <span style=color:#fabd2f>setne</span>   <span style=color:#d3869b>al</span>
</span></span><span style=display:flex><span>        <span style=color:#fabd2f>ret</span>     <span style=color:#d3869b>0</span>
</span></span><span style=display:flex><span><span style=color:#fabd2f>int</span> <span style=color:#d3869b>foo1</span>(<span style=color:#d3869b>void</span>) <span style=color:#d3869b>ENDP</span>                                 <span style=color:#928374;font-style:italic>; foo1
</span></span></span><span style=display:flex><span><span style=color:#928374;font-style:italic></span>
</span></span><span style=display:flex><span><span style=color:#fabd2f>_main</span>   <span style=color:#d3869b>PROC</span>                                      <span style=color:#928374;font-style:italic>; COMDAT
</span></span></span><span style=display:flex><span><span style=color:#928374;font-style:italic></span>        <span style=color:#fabd2f>xor</span>     <span style=color:#d3869b>eax</span>, <span style=color:#d3869b>eax</span>
</span></span><span style=display:flex><span>        <span style=color:#fabd2f>ret</span>     <span style=color:#d3869b>0</span>
</span></span><span style=display:flex><span><span style=color:#fabd2f>_main</span>   <span style=color:#d3869b>ENDP</span>
</span></span></code></pre></td></tr></table></div></div><p>GCC:</p><div class=highlight><div style=color:#ebdbb2;background-color:#282828;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#ebdbb2;background-color:#282828;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-5-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-5-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-5-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-5-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-5-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-5-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-5-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-5-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-5-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-5-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-5-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-5-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-5-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-5-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-5-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-5-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-5-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-5-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-18>18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-5-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-19>19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59" id=hl-5-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-20>20</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#ebdbb2;background-color:#282828;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-asm data-lang=asm><span style=display:flex><span><span style=color:#fabd2f>foo3</span>():
</span></span><span style=display:flex><span>        <span style=color:#fabd2f>cmp</span>     <span style=color:#d3869b>DWORD</span> <span style=color:#d3869b>PTR</span> <span style=color:#d3869b>g_fullscreen</span>[<span style=color:#d3869b>rip</span>], <span style=color:#d3869b>0</span>
</span></span><span style=display:flex><span>        <span style=color:#fabd2f>setne</span>   <span style=color:#d3869b>al</span>
</span></span><span style=display:flex><span>        <span style=color:#fabd2f>movzx</span>   <span style=color:#d3869b>eax</span>, <span style=color:#d3869b>al</span>
</span></span><span style=display:flex><span>        <span style=color:#fabd2f>ret</span>
</span></span><span style=display:flex><span><span style=color:#fabd2f>foo2</span>():
</span></span><span style=display:flex><span>        <span style=color:#fabd2f>cmp</span>     <span style=color:#d3869b>DWORD</span> <span style=color:#d3869b>PTR</span> <span style=color:#d3869b>g_fullscreen</span>[<span style=color:#d3869b>rip</span>], <span style=color:#d3869b>0</span>
</span></span><span style=display:flex><span>        <span style=color:#fabd2f>setne</span>   <span style=color:#d3869b>al</span>
</span></span><span style=display:flex><span>        <span style=color:#fabd2f>movzx</span>   <span style=color:#d3869b>eax</span>, <span style=color:#d3869b>al</span>
</span></span><span style=display:flex><span>        <span style=color:#fabd2f>ret</span>
</span></span><span style=display:flex><span><span style=color:#fabd2f>foo1</span>():
</span></span><span style=display:flex><span>        <span style=color:#fabd2f>cmp</span>     <span style=color:#d3869b>DWORD</span> <span style=color:#d3869b>PTR</span> <span style=color:#d3869b>g_fullscreen</span>[<span style=color:#d3869b>rip</span>], <span style=color:#d3869b>0</span>
</span></span><span style=display:flex><span>        <span style=color:#fabd2f>setne</span>   <span style=color:#d3869b>al</span>
</span></span><span style=display:flex><span>        <span style=color:#fabd2f>movzx</span>   <span style=color:#d3869b>eax</span>, <span style=color:#d3869b>al</span>
</span></span><span style=display:flex><span>        <span style=color:#fabd2f>ret</span>
</span></span><span style=display:flex><span><span style=color:#fb4934>main:</span>
</span></span><span style=display:flex><span>        <span style=color:#fabd2f>mov</span>     <span style=color:#d3869b>eax</span>, <span style=color:#d3869b>0</span>
</span></span><span style=display:flex><span>        <span style=color:#fabd2f>ret</span>
</span></span><span style=display:flex><span><span style=color:#fb4934>g_fullscreen:</span>
</span></span><span style=display:flex><span>        <span style=color:#b8bb26;font-weight:700>.zero</span>   <span style=color:#d3869b>4</span>
</span></span></code></pre></td></tr></table></div></div><p>It turns out that for this specific case, using the trick == conditional statement == tenary operator.
That is, there is no performance difference!</p><p>In conclusion, just put this trick into your bag.
Don&rsquo;t go around crusading other to use it :)</p></div></div></div></body></html>